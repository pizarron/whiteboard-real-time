<!DOCTYPE html>
<html>
    <!-- Head -->
    <head>
        <script src="js/socket.io.js"></script>
        <script src="js/jquery.min.js"></script>
        <script type="text/javascript">
            /* Socket.io */
            var socketChat = io.connect("http://localhost:9090/chat"); // Socket Chat
            var socketWBoard = io.connect("http://localhost:9090/wboard"); // Socket Whiteboard
            /*
            Este metodo se encarha de recibir los datos enviados por el profesor
            */
            socketWBoard.on('receive_datas', function(datas){
                console.log(JSON.stringify(datas));
                $('#chatLog').append(JSON.stringify(datas));
                $('#chatLog').append($('<br />'));
            });
            /* Javascript */
            /*
            Lanza el evento join_room pasandole el nombre del aula (room) al cual se quiere unir
             */
            function JoinToRoom(){
                var role = 'teacher';
                if (document.getElementById('student').checked){
                    role = 'student';
                }
                var room = $('#sltCourseClass').val();
                console.log(room + ' ' + role);
                socketWBoard.emit('join_room', { role : role, room: room });
            }
            /*
             Lanza el evento leave_room pasandole el nombre del aula (room) del cual quiere salir
             */
            function LeaveRoom(){
                var room = $('#sltCourseClass').val();
                socketWBoard.emit('leave_room', room);
            }
            /*
             Lanza el evento send_data enviando como parametros el aula (room), y los datos de la pizarra
             Nota: Este metodo unicamente deberia ser usado por el profesor
             */
            function SendData(){
                var currentRoom = $('#sltCourseClass').val();
                var user = $('#txtUserName').val();
                var datas = $('#txtMessageContent').val();
                socketWBoard.emit('send_data', { room : currentRoom, data: user + ': ' + datas, clear: false });
            }
        </script>
    </head>
    <!-- Body -->
    <body>
        <h1>Whiteboard client</h1>
        Name:
        <input type="text" id="txtUserName" /><br/>
        Role:
        <br />
        <input id="teacher" name="role" type="radio" value="teacher" checked="checked" />
        <label for="teacher">Teacher</label>
        <br />
        <input id="student" name="role" type="radio" value="student" />
        <label for="teacher">Student</label>
        <br />
        Course class:
        <select id="sltCourseClass">
            <option value="room001">Room 1</option>
            <option value="room002">Room 2</option>
            <option value="room003">Room 3</option>
        </select>
        <input type="button" value="Join a class" onclick="JoinToRoom()" />
        <br />
        <textarea id="txtMessageContent"></textarea>
        <input type="button" value="Send message" onclick="SendData()" />
        <br />
        <div id="chatLog"></div>
    </body>
</html>